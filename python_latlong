import csv
from pyproj import Proj, transform

# Define the input and output file paths
# Define the input and output file paths
input_csv = 'PointHeatCO2.csv'
output_csv = 'output_lat_lon.csv'

# Define the projections for British National Grid (EPSG:27700) to WGS84 (EPSG:4326)
proj_bng = Proj(init='epsg:27700')  # British National Grid (OSGB36)
proj_latlon = Proj(init='epsg:4326')  # WGS84 Latitude/Longitude

# Open the input CSV file and read Eastings/Northings
with open(input_csv, mode='r') as infile, open(output_csv, mode='w', newline='') as outfile:
    reader = csv.DictReader(infile)
    fieldnames = reader.fieldnames + ['Latitude', 'Longitude']
    writer = csv.DictWriter(outfile, fieldnames=fieldnames)
    
    writer.writeheader()  # Write the header row
    
    for row in reader:
        easting = float(row['Easting'])
        northing = float(row['Northing'])
        
        # Convert Easting/Northing to Latitude/Longitude
        longitude, latitude = transform(proj_utm, proj_latlon, easting, northing)
        
        # Add the Latitude and Longitude to the row
        row['Latitude'] = latitude
        row['Longitude'] = longitude
        
        # Write the row to the output CSV
        writer.writerow(row)

print(f"Conversion complete. Output saved to {output_csv}")
